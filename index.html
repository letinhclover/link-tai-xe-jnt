<!DOCTYPE html>
<html lang="vi">
<head>
<!-- 1. X√ÅC MINH & C·∫§U H√åNH -->
<meta name="google-site-verification" content="dE9NgLvppbsz9DsFv3CwhHBR8KNF9hiM5CDQ2Houyvc" />
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Link T√†i X·∫ø J&T Express</title>

<!-- 2. PWA & ICONS -->
<link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff0033">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="application-name" content="Link T√†i X·∫ø J&T">

<!-- 3. FONTS & SEO -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<meta name="description" content="Link t√†i x·∫ø J&T Express: T·ªïng h·ª£p Link n·ªôi b·ªô, Nh√≥m Zalo, T√≠nh l∆∞∆°ng, D·∫ßu, Map kho. T·∫•t c·∫£ trong m·ªôt.">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://letinhclover.github.io/jntdriver">

<style>
/* CSS GIAO DI·ªÜN */
:root {
  --bg-light: #f8fafc; --bg-dark: #111214;
  --text-light: #0b0b0b; --text-dark: #f5f5f5;
  --primary: #CC0000; --accent: #198845;
  --card: #ffffff; --card-dark: #1d1f21;
  --highlight-bg: #fff3f2;
  --edit: #f39c12;
  --blue-text: #007bff; 
  --red-text: #d32f2f;
  --safe: #2ecc71; 
  --warn: #f1c40f;
}
*, *::before, *::after { box-sizing: border-box; }

body {
  font-family: 'Roboto', sans-serif;
  margin: 0; background: var(--bg-light); color: var(--text-light);
  transition: background .25s, color .25s;
  -webkit-tap-highlight-color: transparent; font-size: 15px; line-height: 1.4;
}
body.dark { background: var(--bg-dark); color: var(--text-dark); }

header {
  background: linear-gradient(90deg, var(--primary), #dd2476);
  color: #fff; padding: 14px 16px; text-align: center;
  position: relative; font-weight: 800; font-size: 1.2em;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
#toggleTheme {
  position: absolute; right: 12px; top: 10px;
  background: none; border: none; color: #fff;
  font-size: 18px; cursor: pointer; padding: 5px;
}

.container { max-width: 720px; margin: 10px auto; padding: 10px; }

/* GROUP STYLES */
.group {
  margin-bottom: 14px; border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,.08);
  background: var(--card);
}
body.dark .group { box-shadow: 0 2px 6px rgba(0,0,0,.3); background: var(--card-dark); }

.group-header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 12px 14px; cursor: pointer; font-weight: 700;
  background: rgba(0,0,0,0.02); border-radius: 10px 10px 0 0; user-select: none;
}
.group-header span.title { color: var(--primary); }
.group-header .arrow { transition: transform .25s; }
.group.open .group-header .arrow { transform: rotate(90deg); }
.group-content { display: none; padding-bottom: 5px; animation: fadeIn 0.2s ease; }
.group.open .group-content { display: block; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* LINK CARDS */
a.link-card {
  display: flex; justify-content: space-between; align-items: center;
  text-decoration: none; color: inherit;
  padding: 10px; border-radius: 8px; margin: 6px 10px;
  background: rgba(0,0,0,0.03); transition: transform .1s;
}
a.link-card:active { transform: scale(0.98); background: rgba(0,0,0,0.08); }
body.dark a.link-card { background: rgba(255,255,255,0.05); }

/* CONTACT GRID */
.contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 10px 12px; }
a.contact-btn {
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  padding: 8px 5px; border-radius: 8px;
  background: rgba(0,0,0,0.03); color: var(--text-light);
  text-decoration: none; height: 60px; text-align: center;
}
body.dark a.contact-btn { background: rgba(255,255,255,0.05); color: var(--text-dark); }
.contact-btn .name-contact { font-weight: 700; font-size: 0.95em; }
.contact-btn .role-contact { font-size: 0.75em; opacity: 0.7; margin-top: 2px; }

.contact-note {
    text-align: center; margin-bottom: 10px;
    font-size: 0.9em; font-style: italic; opacity: 0.8;
    color: var(--text-light);
}
body.dark .contact-note { color: var(--text-dark); }

/* INPUTS & BUTTONS */
.calc-content { padding: 14px; display: flex; flex-direction: column; align-items: center; gap: 12px; }
.input-group-calc { width: 94%; max-width: 580px; }
.calc-label { display: block; margin-top: 8px; font-weight: 600; font-size: 15px; }
.calc-input {
  width: 100%; padding: 12px; margin-top: 4px;
  border: 1px solid #ccc; border-radius: 8px; font-size: 16px;
  background: var(--bg-light); color: var(--text-light);
}
body.dark .calc-input { border-color: #555; background: #2b2b2b; color: var(--text-dark); }

button.calc-submit {
  width: 92%; max-width: 600px; padding: 12px;
  border-radius: 10px; font-size: 16px; font-weight: 700;
  margin-top: 15px;
  border: none; background: var(--primary); color: #fff; cursor: pointer;
}
button.calc-submit:active { opacity: .9; transform: translateY(1px); }
button.btn-update { background: var(--edit) !important; }

/* LAYOUT 3 C·ªòT CHO L∆Ø∆†NG */
.salary-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; width: 94%; max-width: 580px; }
.salary-col { display: flex; flex-direction: column; }
.salary-col .calc-label { font-size: 13px; margin-top: 0; margin-bottom: 2px; text-align: center; }
.salary-col .calc-input { text-align: center; padding: 10px 4px; font-weight: 500; }

/* RESULT BOXES */
.result-box, .result-box-ot {
  width: 92%; max-width: 600px; margin-top: 10px; padding: 12px;
  border-radius: 10px; font-size: 15px; line-height: 1.5;
}
.result-box { background: rgba(0,0,0,0.05); }
body.dark .result-box { background: rgba(255,255,255,0.05); color: var(--text-dark); }
.result-box-ot { background-color: var(--highlight-bg); border: 1px solid var(--primary); }
body.dark .result-box-ot { background-color: #312121; border: 1px solid rgba(255,255,255,0.1); }

.result-box-ot h3 { color: var(--primary); font-size: 1.1em; margin: 0 0 8px 0; border-bottom: 1px dashed #ccc; padding-bottom: 5px; text-align: center; }

/* GRID K·∫æT QU·∫¢ L∆Ø∆†NG */
.result-grid-row {
    display: grid;
    grid-template-columns: 45% 15% 40%; 
    align-items: center;
    margin: 10px 0;
    border-bottom: 1px dashed rgba(0,0,0,0.1);
    padding-bottom: 6px;
}
body.dark .result-grid-row { border-color: rgba(255,255,255,0.1); }

.grid-label { font-weight: 700; text-align: left; font-size: 1.0em; }
.grid-hours { font-weight: 700; text-align: center; font-size: 1.1em; } 
.grid-money { font-weight: 700; text-align: right; font-size: 1.1em; }

/* M√ÄU S·∫ÆC TƒÇNG CA */
.text-blue { color: var(--blue-text); }
body.dark .text-blue { color: #4da3ff; }
.text-red { color: var(--red-text); }
body.dark .text-red { color: #ff6659; }

.result-item { display: flex; justify-content: space-between; margin: 6px 0; }
.result-item-total { font-size: 1.05em; font-weight: 700; border-top: 2px solid #ff9788; padding-top: 8px; margin-top: 8px; color: var(--primary); display: flex; justify-content: space-between; align-items: center; }
.ot-note { font-size: 0.85em; font-style: italic; opacity: 0.8; margin-top: 10px; border-top: 1px solid #ddd; padding-top: 5px; text-align: center; }

/* LOGBOOK STYLE */
.odo-setup {
    background: rgba(0,0,0,0.03); padding: 10px; 
    border-radius: 8px; border: 1px solid var(--accent);
    margin-bottom: 10px; width: 100%;
}
body.dark .odo-setup { background: rgba(25, 136, 69, 0.1); }

/* HEADER ROW CHO NH·∫¨T K√ù D·∫¶U */
.fuel-log-header {
    display: grid;
    grid-template-columns: 15% 12% 18% 13% 17% 25%;
    gap: 4px;
    padding: 10px 8px;
    background: linear-gradient(135deg, var(--primary), #dd2476);
    color: #fff;
    font-weight: 700;
    font-size: 0.8em;
    text-align: center;
    border-radius: 8px 8px 0 0;
    margin: 0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.fuel-log-header > div {
    display: flex;
    align-items: center;
    justify-content: center;
}

.log-input-container {
    width: 100%; background: rgba(0,0,0,0.02);
    padding: 8px; border-radius: 8px; border: 1px solid #eee;
}
body.dark .log-input-container { background: rgba(255,255,255,0.05); border-color: #333; }

.log-row-1 { width: 100%; margin-bottom: 8px; } 
.log-row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; } 

.log-input { padding: 12px; border: 1px solid #ccc; border-radius: 5px; width: 100%; font-size: 15px; }
body.dark .log-input { background: #2b2b2b; border-color: #555; color: #fff; }
.log-select { padding: 12px; border: 1px solid #ccc; border-radius: 5px; width: 100%; font-size: 15px; background: #fff; }
body.dark .log-select { background: #2b2b2b; color: #fff; border-color: #555; }

.log-list { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
.log-list th { background: rgba(0,0,0,0.05); padding: 8px 4px; text-align: left; font-size: 12px; color: var(--primary); }
body.dark .log-list th { background: rgba(255,255,255,0.1); }
.log-list td { border-bottom: 1px solid rgba(0,0,0,0.1); padding: 10px 4px; vertical-align: middle; }
body.dark .log-list td { border-bottom: 1px solid rgba(255,255,255,0.3); } 

/* FUEL LOG CARD - Grid Layout */
.log-card-fuel {
    display: grid;
    grid-template-columns: 15% 12% 18% 13% 17% 25%;
    gap: 4px;
    align-items: center;
    padding: 8px 8px;
    margin: 0 0 3px 0;
    background: rgba(0,0,0,0.03);
    border-radius: 6px;
    font-size: 0.85em;
    transition: all 0.15s;
}
.log-card-fuel:active {
    transform: scale(0.98);
    background: rgba(0,0,0,0.08);
}
body.dark .log-card-fuel {
    background: rgba(255,255,255,0.05);
}
body.dark .log-card-fuel:active {
    background: rgba(255,255,255,0.1);
}

.log-card-fuel > div {
    text-align: center;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.log-card-fuel .fuel-date {
    font-weight: 600;
    color: var(--text-light);
}
body.dark .log-card-fuel .fuel-date {
    color: var(--text-dark);
}

.log-card-fuel .fuel-actions {
    display: flex;
    justify-content: center;
    gap: 2px;
}
 

.log-action-btn { font-size: 16px; border: none; background: none; cursor: pointer; margin-left: 4px; padding: 2px 4px; }
.btn-edit { color: var(--edit); }
.btn-del { color: #999; }

.log-summary {
    background: var(--highlight-bg); border: 1px dashed var(--primary);
    border-radius: 8px; padding: 10px; margin-top: 15px; width: 100%;
    font-size: 14px;
}
body.dark .log-summary { background: #312121; border-color: rgba(255,255,255,0.2); }
.log-summary div { margin-bottom: 4px; display: flex; justify-content: space-between; }

/* NOTEBOOK STYLE */
.note-area {
  width: 96%; height: 120px; padding: 10px;
  border: 1px solid #ccc; border-radius: 8px;
  font-family: inherit; margin: 10px auto; display: block;
  background: var(--bg-light); color: var(--text-light); font-size: 16px;
}
body.dark .note-area { background: #2b2b2b; color: var(--text-dark); border-color: #555; }
.save-btn { background: var(--accent); color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }

/* --- NH·∫ÆC L·ªäCH XE STYLE COMPACT --- */
.reminder-compact-row {
    display: flex; justify-content: space-between; align-items: center;
    width: 96%; margin: 6px auto; padding: 12px 14px;
    background: rgba(0,0,0,0.03); border-radius: 10px; border: 1px solid #eee;
}
body.dark .reminder-compact-row { background: rgba(255,255,255,0.05); border-color: #333; }

.reminder-info { flex: 1; }
.reminder-label-main { font-weight: 700; font-size: 1.05em; display: block; margin-bottom: 2px; }
.reminder-status-text { font-size: 0.92em; font-weight: 500; }

.btn-edit-toggle {
    background: #7f8c8d; color: white; border: none; padding: 8px 14px;
    border-radius: 8px; font-size: 13px; font-weight: 800; cursor: pointer; 
    margin-left: 12px; min-width: 65px;
}
.btn-edit-toggle.active { background: var(--accent); }

.edit-area { 
    display: none; width: 96%; margin: -4px auto 10px; padding: 15px; 
    background: var(--card); border-radius: 0 0 10px 10px; 
    border: 2px solid #ddd; border-top: none;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
body.dark .edit-area { background: var(--card-dark); border-color: #444; }

.reminder-input-pro { 
    width: 100%; height: 50px; padding: 0 15px; 
    border: 2px solid #cbd5e1; border-radius: 10px; 
    font-size: 18px; font-weight: 700; color: var(--text-light);
    background: var(--bg-light); font-family: inherit;
    box-sizing: border-box;
}
body.dark .reminder-input-pro { background: #2b2b2b; color: #fff; border-color: #444; }
.reminder-input-pro:focus { border-color: var(--blue-text); outline: none; background: #fff; }

.expert-advice-box {
    width: 96%; margin: 12px auto; padding: 14px; border-radius: 12px;
    background: #e1f5fe; color: #01579b; border: 1px solid #b3e5fc; 
    font-size: 0.95em; line-height: 1.5;
}
body.dark .expert-advice-box { background: #012b3d; color: #b3e5fc; border-color: #01579b; }

/* B·∫¢NG TRA C·ª®U H√ÄNG NGANG */
.maintenance-header-row {
    display: flex; justify-content: space-between; align-items: center;
    width: 96%; margin: 18px auto 5px; padding: 0 5px;
}
.maintenance-title { font-weight: 800; color: var(--primary); font-size: 0.95em; text-transform: uppercase; }
.btn-lookup-toggle {
    background: var(--blue-text); color: white; border: none; padding: 6px 18px;
    border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 13px;
}

.maintenance-table {
    display: none; width: 96%; margin: 5px auto 15px; border-collapse: collapse;
    font-size: 15px; background: var(--card); border-radius: 8px; overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
body.dark .maintenance-table { background: var(--card-dark); border: 1px solid #444; }
.maintenance-table th { background: var(--primary); color: white; padding: 12px 10px; text-align: left; font-size: 14px; }
.maintenance-table td { padding: 14px 10px; border-bottom: 1px solid #eee; vertical-align: top; line-height: 1.4; }
body.dark .maintenance-table td { border-bottom: 1px solid #444; }
.maintenance-table tr:last-child td { border: none; }
.m-cap { font-weight: 800; color: var(--primary); font-size: 1.05em; display: block; margin-bottom: 2px; }
.m-odo { font-weight: 700; color: var(--text-light); opacity: 0.8; font-size: 0.9em; }
body.dark .m-odo { color: var(--text-dark); }

/* TOAST NOTIFICATION STYLE */
#toast {
    visibility: hidden; min-width: 250px; background-color: #333; color: #fff;
    text-align: center; border-radius: 50px; padding: 16px; position: fixed;
    z-index: 1000; left: 50%; bottom: 30px; transform: translateX(-50%);
    font-size: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
#toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
@keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
@keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

/* SINGLE LINE LIST ITEM CHO NH·∫¨T K√ù (COMPACT PRO) */
.log-cards-container {
    width: 100%; padding: 8px 5px;
}

/* HEADER ROW CHO NH·∫¨T K√ù TƒÇNG CA */
.ot-log-header {
    display: grid;
    grid-template-columns: 22% 28% 23% 27%;
    gap: 4px;
    padding: 10px 8px;
    background: linear-gradient(135deg, var(--blue-text), #4da3ff);
    color: #fff;
    font-weight: 700;
    font-size: 0.8em;
    text-align: center;
    border-radius: 8px 8px 0 0;
    margin: 0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.ot-log-header > div {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* OT LOG CARD - Grid Layout */
.log-card-ot {
    display: grid;
    grid-template-columns: 22% 28% 23% 27%;
    gap: 4px;
    align-items: center;
    padding: 8px 8px;
    margin: 0 0 3px 0;
    background: rgba(0,0,0,0.03);
    border-radius: 6px;
    font-size: 0.88em;
    transition: all 0.15s;
}
.log-card-ot:active {
    transform: scale(0.98);
    background: rgba(0,0,0,0.08);
}
body.dark .log-card-ot {
    background: rgba(255,255,255,0.05);
}
body.dark .log-card-ot:active {
    background: rgba(255,255,255,0.1);
}

.log-card-ot > div {
    text-align: center;
}

.log-card-ot .ot-date {
    font-weight: 600;
    color: var(--text-light);
}
body.dark .log-card-ot .ot-date {
    color: var(--text-dark);
}

.log-card-ot .ot-actions {
    display: flex;
    justify-content: center;
    gap: 2px;
}

/* Gi·ªØ l·∫°i style c≈© cho backward compatibility */
.log-card {
    background: var(--card); border: 1px solid rgba(0,0,0,0.08);
    border-radius: 8px; padding: 10px 12px; margin-bottom: 6px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    display: flex; align-items: center; justify-content: space-between;
    transition: transform 0.1s;
}
body.dark .log-card { background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); }
.log-card:active { transform: scale(0.98); }

.log-card-date {
    font-weight: 700; font-size: 0.85em; color: var(--primary);
    min-width: 55px; flex-shrink: 0;
}

.log-card-info {
    flex: 1; padding: 0 10px;
    display: flex; gap: 8px; align-items: center;
    font-size: 0.88em;
}

.log-card-actions {
    display: flex; gap: 6px; flex-shrink: 0;
}

/* M√†u cho TƒÉng ca */
.card-ot-normal .log-card-type, .card-ot-normal .log-card-hours {
    color: var(--blue-text); font-weight: 700;
}
body.dark .card-ot-normal .log-card-type, body.dark .card-ot-normal .log-card-hours {
    color: #4da3ff;
}
.card-ot-off .log-card-type, .card-ot-off .log-card-hours {
    color: var(--red-text); font-weight: 700;
}
body.dark .card-ot-off .log-card-type, body.dark .card-ot-off .log-card-hours {
    color: #ff6659;
}

.log-card-value {
    font-weight: 600;
}

/* Empty state */
.log-empty-state {
    text-align: center; padding: 30px 20px;
    opacity: 0.5; font-style: italic; font-size: 0.95em;
}

/* SECTION DIVIDER */
.section-title {
    padding: 10px 10px 5px 10px; font-weight: bold; color: var(--primary); 
    border-bottom: 1px solid rgba(0,0,0,0.1); margin: 15px 10px 5px 10px;
    font-size: 0.95em; text-transform: uppercase;
}
body.dark .section-title { border-color: rgba(255,255,255,0.1); }

/* QR SHARE */
.qr-container { text-align: center; padding: 10px; margin-top:10px;}
.qr-img { 
    width: 160px; height: 160px; 
    mix-blend-mode: multiply;
    margin-bottom: 10px;
    background-color: #fff; border: 5px solid #fff; border-radius: 8px;
}
body.dark .qr-img { mix-blend-mode: normal; border: 4px solid #fff; }

.share-btn-native {
    background: #007bff; color: white; border: none;
    padding: 12px 25px; border-radius: 30px;
    font-weight: bold; cursor: pointer;
    font-size: 16px; display: inline-flex; align-items: center; gap: 8px;
    box-shadow: 0 4px 10px rgba(0,123,255,0.3);
    transition: transform 0.1s;
}
.share-btn-native:active { transform: scale(0.95); }

/* INTRO */
.intro-box {
    padding: 15px; margin: 10px 5px;
    font-size: 0.95em; color: #444; line-height: 1.6; text-align: justify;
    background: rgba(0,0,0,0.02); border-radius: 8px; border-left: 3px solid #ccc;
}
body.dark .intro-box { color: #ccc; background: rgba(255,255,255,0.05); }

.author-box {
    text-align: center; font-size: 0.9em; color: var(--text-light); margin-top: 20px; border-top:1px dashed #ccc; padding-top:15px;
}
body.dark .author-box { color: var(--text-dark); }

footer { padding: 15px; text-align: center; background: var(--card); border-top: 1px solid rgba(0,0,0,.04); margin-top: 20px; }
body.dark footer { background: var(--card-dark); }
.footer-text { font-weight: bold; color: var(--primary); font-size: 0.9em; }
.footer-link { color: var(--accent); font-weight: 700; text-decoration: none; }

/* BACKUP CONTAINER */
.backup-container {
    background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
    border: 2px dashed #2196f3;
    border-radius: 12px;
    padding: 16px;
    margin: 10px;
    box-shadow: 0 2px 8px rgba(33, 150, 243, 0.1);
}
body.dark .backup-container {
    background: linear-gradient(135deg, #1a237e 0%, #4a148c 100%);
    border-color: #42a5f5;
}

.backup-description {
    margin-bottom: 12px;
    padding-bottom: 12px;
    border-bottom: 1px solid rgba(0,0,0,0.1);
}
body.dark .backup-description {
    border-bottom-color: rgba(255,255,255,0.1);
}

.backup-buttons {
    display: flex;
    gap: 10px;
    margin-bottom: 16px;
}

.backup-btn {
    flex: 1;
    padding: 10px 12px;
    border: none;
    border-radius: 8px;
    font-size: 0.9em;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.backup-export {
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    color: white;
}
.backup-export:active {
    transform: scale(0.97);
    box-shadow: 0 1px 2px rgba(0,0,0,0.2);
}

.backup-import {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
}
.backup-import:active {
    transform: scale(0.97);
    box-shadow: 0 1px 2px rgba(0,0,0,0.2);
}

.backup-guide {
    background: rgba(255,255,255,0.7);
    border-radius: 8px;
    padding: 12px;
    font-size: 0.85em;
}
body.dark .backup-guide {
    background: rgba(0,0,0,0.3);
}

.guide-step {
    display: flex;
    gap: 8px;
    margin-bottom: 10px;
    line-height: 1.5;
    align-items: flex-start;
}

.step-number {
    font-size: 1.1em;
    flex-shrink: 0;
}

.step-text {
    flex: 1;
    color: var(--text-light);
}
body.dark .step-text {
    color: var(--text-dark);
}

.guide-note {
    margin-top: 12px;
    padding: 8px 10px;
    background: #fff9e6;
    border-left: 3px solid #f1c40f;
    border-radius: 4px;
    color: #856404;
    line-height: 1.4;
}
body.dark .guide-note {
    background: #3d3500;
    color: #ffd54f;
    border-color: #ffc107;
}

</style>
</head>
<body>

<header>
  LINK T√ÄI X·∫æ J&T
  <button id="toggleTheme" aria-label="chuy·ªÉn s√°ng t·ªëi">üåô</button>
</header>

<main class="container">
  
  <!-- 1. C√îNG VI·ªÜC -->
  <div class="group">
    <div class="group-header" role="button" tabindex="0">
      <span class="title">üìã C√¥ng vi·ªác n·ªôi b·ªô</span><span class="arrow">‚ñ∂</span>
    </div>
    <div class="group-content">
      <a class="link-card" href="https://jntexpress.vn/attendance" target="_blank" rel="noopener noreferrer"><div class="link-left">CH·∫§M C√îNG CRM</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlgwao5eoTslB2Ds1auT05WPg" target="_blank" rel="noopener noreferrer"><div class="link-left">B√ÅO C√ÅO H√ÄNH TR√åNH</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlgwwFr50osovPX8c5EuYkpVe" target="_blank" rel="noopener noreferrer"><div class="link-left">ƒêI·ªÄN TH√îNG TIN TƒÇNG CA</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlgeJOb7CxaLL18zxNj6gz1kd" target="_blank" rel="noopener noreferrer"><div class="link-left">ƒêƒÇNG K√ç NGH·ªà PH√âP</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlgcx3ZWJlUeZ007y7NOMDtAf" target="_blank" rel="noopener noreferrer"><div class="link-left">CHECK LIST KI·ªÇM TRA XE H·∫∞NG NG√ÄY</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlg4jTyiyUBTxoWnXnh3E2jVh" target="_blank" rel="noopener noreferrer"><div class="link-left">KH√îNG B·∫§M APP, ƒêI·ªÄN NGUY√äN NH√ÇN</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlglpEg10qLFAoBoN6FYGm0Nv" target="_blank" rel="noopener noreferrer"><div class="link-left">G·ª¨I H√åNH V√Å V·ªé, LINK CHU·∫®N</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlgj3VYEKTEh7tTSaZvfpP7HL" target="_blank" rel="noopener noreferrer"><div class="link-left">B√ÅO C√ÅO TH√ôNG XE TR·ªêNG</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlgHKbeP4ff2P8AoaQcWUzicc" target="_blank" rel="noopener noreferrer"><div class="link-left">B√ÅO C√ÅO TH√îNG TIN ƒê·ªî D·∫¶U</div></a>
      <a class="link-card" href="https://jtexpress.sg.feishu.cn/share/base/form/shrlgPi18jGohtl9znrsxLdlDhh" target="_blank" rel="noopener noreferrer"><div class="link-left">B·ªî SUNG TƒÇNG CA B·ªä THI·∫æU</div></a>
    </div>
  </div>

  <!-- 2. ZALO -->
  <div class="group">
    <div class="group-header" role="button" tabindex="0">
      <span class="title">üí¨ Group Zalo</span><span class="arrow">‚ñ∂</span>
    </div>
    <div class="group-content">
      <a class="link-card" href="https://zalo.me/g/uolmnc539" target="_blank" rel="noopener noreferrer"><div class="link-left">Nh√≥m b√°o c√°o n·ªôi th√†nh</div></a>
      <a class="link-card" href="https://zalo.me/g/plhjmt899" target="_blank" rel="noopener noreferrer"><div class="link-left">Nh√≥m b·∫•t th∆∞·ªùng n·ªôi th√†nh</div></a>
      <a class="link-card" href="https://zalo.me/g/byikns239" target="_blank" rel="noopener noreferrer"><div class="link-left">Nh√≥m th√¥ng b√°o t√†i x·∫ø J&T</div></a>
      <a class="link-card" href="https://zalo.me/g/xuizfi412" target="_blank" rel="noopener noreferrer"><div class="link-left">Nh√≥m b√°o c√°o ƒë·ªï d·∫ßu tuy·∫øn nh√°nh</div></a>
    </div>
  </div>

  <!-- 3. LI√äN H·ªÜ -->
  <div class="group">
    <div class="group-header" role="button" tabindex="0">
      <span class="title">üìû Li√™n h·ªá Zalo H·ªó tr·ª£</span><span class="arrow">‚ñ∂</span>
    </div>
    <div class="group-content">
        <div class="contact-note"><i>‚ö†Ô∏è B·∫•m v√†o t√™n ƒë·ªÉ nh·∫Øn tin Zalo tr·ª±c ti·∫øp.</i></div>
        <div class="contact-grid">
            
            <!-- ƒê·ªòI TR∆Ø·ªûNG -->
            <div style="grid-column: 1/3; font-weight: 700; color: var(--primary); padding-top: 5px; border-bottom: 1px dashed #ccc; margin-bottom: 5px;">ƒê·ªòI TR∆Ø·ªûNG</div>
            <a href="https://zalo.me/0973235381" target="_blank" rel="noopener noreferrer" class="contact-btn" style="grid-column: 1/3;">
                <span class="name-contact">Giang Nguy·ªÖn</span>
                <span class="role-contact">ƒê·ªôi tr∆∞·ªüng ƒë·ªôi xe</span>
            </a>
            <a href="https://zalo.me/0762244662" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Tr√≠ L√™</span>
                <span class="role-contact">ƒê·ªôi tr∆∞·ªüng ca ng√†y</span>
            </a>
            <a href="https://zalo.me/0357088743" target="_blank" rel="noopener noreferrer" class="contact-btn"> 
                <span class="name-contact">Ho√†ng Tr·∫ßn</span>
                <span class="role-contact">ƒê·ªôi tr∆∞·ªüng ca ƒë√™m</span>
            </a>

            <!-- B·∫¢O TR√å -->
            <div style="grid-column: 1/3; font-weight: 700; color: var(--primary); padding-top: 15px; border-bottom: 1px dashed #ccc; margin-bottom: 5px;">B·∫¢O TR√å XE</div>
            <a href="https://zalo.me/0937427708" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Ho√†ng Trung</span>
                <span class="role-contact">B·∫£o tr√¨ Thaco, Isuzu</span>
            </a>
            <a href="https://zalo.me/0906722489" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Thanh Li√™m</span>
                <span class="role-contact">B·∫£o tr√¨ Jac, Gaz</span>
            </a>

            <!-- ƒêI·ªÄU PH·ªêI -->
            <div style="grid-column: 1/3; font-weight: 700; color: var(--primary); padding-top: 15px;">ƒêI·ªÄU PH·ªêI</div>
            
            <!-- CA S√ÅNG -->
            <div style="grid-column: 1/3; text-align: center; font-size: 0.85em; font-weight: 600; background: rgba(25, 136, 69, 0.15); color: var(--accent); border-radius: 4px; padding: 4px 0;">CA S√ÅNG (7h - 17h30) üü¢</div>
            <a href="https://zalo.me/0399007309" target="_blank" rel="noopener noreferrer" class="contact-btn" style="grid-column: 1/3;">
                <span class="name-contact">ƒê·∫∑ng Qu·ªëc Th√°i</span>
                <span class="role-contact">ƒêi·ªÅu ph·ªëi VP</span>
            </a>
            <a href="https://zalo.me/0972251731" target="_blank" rel="noopener noreferrer" class="contact-btn" style="grid-column: 1/3;">
                <span class="name-contact">Nguy·ªÖn Ti·∫øn Trung</span>
                <span class="role-contact">TTTC (7h-16h)</span>
            </a>

            <!-- CA CHI·ªÄU -->
            <div style="grid-column: 1/3; text-align: center; font-size: 0.85em; font-weight: 600; background: rgba(255, 165, 0, 0.2); color: #CC6600; border-radius: 4px; padding: 4px 0; margin-top: 8px;">CA NG√ÄY (12h - 21h) üü†</div>
            <a href="https://zalo.me/0962073793" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Ph·∫°m Minh K·ª≥</span>
                <span class="role-contact">GW0 (12h-21h)</span>
            </a>
            <a href="https://zalo.me/0365762179" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Nguy·ªÖn T·∫•n T√†i</span>
                <span class="role-contact">GW0 (12h-21h)</span>
            </a>
            <a href="https://zalo.me/0764341791" target="_blank" rel="noopener noreferrer" class="contact-btn" style="grid-column: 1/3;">
                <span class="name-contact">Nguy·ªÖn Ho√†ng Ph√∫c</span>
                <span class="role-contact">GW0 (12h-21h)</span>
            </a>

            <!-- CA T·ªêI -->
            <div style="grid-column: 1/3; text-align: center; font-size: 0.85em; font-weight: 600; background: rgba(204, 0, 0, 0.15); color: var(--primary); border-radius: 4px; padding: 4px 0; margin-top: 8px;">CA T·ªêI (18h - 3h/4h) üî¥</div>
            <a href="https://zalo.me/0886468035" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">H·ªì S·ªπ L∆∞u</span>
                <span class="role-contact">18h-3h</span>
            </a>
            <a href="https://zalo.me/0933450410" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Nguy·ªÖn G.Q M·∫°nh</span>
                <span class="role-contact">18h-3h</span>
            </a>
            <a href="https://zalo.me/0363456035" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">ƒê·∫∑ng Tu·∫•n Ki·ªát</span>
                <span class="role-contact">18h-3h</span>
            </a>
            <a href="https://zalo.me/0964543757" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Ph·∫°m ƒê·ª©c Huy</span>
                <span class="role-contact">18h-3h</span>
            </a>
            <a href="https://zalo.me/0869814645" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Nguy·ªÖn Th√†nh Vinh</span>
                <span class="role-contact">TTTC xe 5T- 9T</span>
            </a>
            <a href="https://zalo.me/0336492538" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Ho√†ng H·∫£i</span>
                <span class="role-contact">GW3 (18h-3h)</span>
            </a>
            <a href="https://zalo.me/0326466205" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Trung H·∫≠u</span>
                <span class="role-contact">GW4 (18h-3h)</span>
            </a>
            <a href="https://zalo.me/0372026225" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">T·∫•n Sang</span>
                <span class="role-contact">18h-3h</span>
            </a>
            <a href="https://zalo.me/0903969713" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Ph√∫c H·∫≠u</span>
                <span class="role-contact">GW6 (18h-3h)</span>
            </a>
             <a href="https://zalo.me/0332277821" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">Minh Quang</span>
                <span class="role-contact">GW5 (19h-4h)</span>
            </a>

            <!-- TTTC ƒê√äM -->
            <div style="grid-column: 1/3; text-align: center; font-size: 0.85em; font-weight: 600; background: #34495e; color: #fff; border-radius: 4px; padding: 4px 0; margin-top: 8px;">TTTC ƒê√äM (21h - 6h) üü£</div>
            <a href="https://zalo.me/0374749130" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">ƒê√†o ƒê·ª©c ƒê·∫°t</span>
                <span class="role-contact">TTTC (21h-6h)</span>
            </a>
            <a href="https://zalo.me/0369702372" target="_blank" rel="noopener noreferrer" class="contact-btn">
                <span class="name-contact">ƒê·ªó Nh·∫≠t Quang</span>
                <span class="role-contact">TTTC (21h-6h)</span>
            </a>
            <a href="https://zalo.me/0947550239" target="_blank" rel="noopener noreferrer" class="contact-btn" style="grid-column: 1/3;">
                <span class="name-contact">Nguy·ªÖn Qu·ªëc Trung</span>
                <span class="role-contact">TTTC (21h-6h)</span>
            </a>

            <!-- TUY·∫æN T·ªàNH -->
            <div style="grid-column: 1/3; text-align: center; font-size: 0.85em; font-weight: 700; color: #007bff; border-top: 1px dashed #ccc; padding-top: 10px; margin-top: 10px;">B√åNH D∆Ø∆†NG - T√ÇY NINH üîµ</div>
             <a href="https://zalo.me/0334457083" target="_blank" rel="noopener noreferrer" class="contact-btn"> 
                 <span class="name-contact">Qu·ªëc Anh</span>
                 <span class="role-contact">GW0 (21h-6h30)</span>
            </a>
            <a href="https://zalo.me/0962073741" target="_blank" rel="noopener noreferrer" class="contact-btn"> 
                <span class="name-contact">H·ªì S·ªπ Ti·∫øn</span>
                <span class="role-contact">GW0 (7h-19h30)</span>
            </a>
        </div>
    </div>
  </div>
  
  <!-- 4. MAPS -->
  <div class="group">
    <div class="group-header" role="button" tabindex="0">
      <span class="title">üìç ƒê·ªãa ch·ªâ Google Map</span><span class="arrow">‚ñ∂</span>
    </div>
    <div class="group-content" id="mapListContainer"></div>
  </div>

  <!-- 5. T√çNH D·∫¶U & NH·∫¨T K√ù -->
  <div class="group">
    <div class="group-header" role="button" tabindex="0">
      <span class="title">üõ¢ T√≠nh D·∫ßu & Nh·∫≠t K√Ω ODO</span><span class="arrow">‚ñ∂</span>
    </div>
    <div class="group-content">
      <div class="calc-content">
        
        <!-- NH·∫¨T K√ù -->
        <div class="section-title" style="margin-top:0" id="fuelInputAnchor">üìí NH·∫¨T K√ù ODO (GHI S·ªî)</div>
        
        <div class="odo-setup">
             <label class="calc-label" style="margin:0">üìå ODO Ch·ªët Th√°ng Tr∆∞·ªõc:</label>
             <div style="display:flex; gap:8px; margin-top:8px;">
                 <input type="number" id="closingOdo" class="calc-input" placeholder="VD: 22000" inputmode="numeric" onfocus="this.select()" min="0">
                 <button class="save-btn" onclick="saveClosingOdo()" style="width:90px">L∆∞u</button>
             </div>
             <div id="savedOdoText" style="font-size:14px; color:var(--accent); margin-top:5px; font-style:italic; font-weight:500"></div>
        </div>

        <div class="log-input-container">
             <div class="log-row-1">
                 <input type="date" id="logDate" class="log-input">
             </div>
             <div class="log-row-2">
                 <input type="number" id="logLiters" class="log-input" placeholder="S·ªë L√≠t" inputmode="decimal" onfocus="this.select()" min="0">
                 <input type="number" id="logOdo" class="log-input" placeholder="ODO Hi·ªán t·∫°i" inputmode="numeric" onfocus="this.select()" min="0">
             </div>
        </div>
        <button class="calc-submit" id="btnAddFuel" onclick="addFuelLog()">‚ûï Th√™m Nh·∫≠t K√Ω</button>
        <button class="calc-submit" id="btnCancelFuel" onclick="cancelFuelEdit()" style="background:#7f8c8d; display:none; margin-top:8px">H·ªßy S·ª≠a</button>

        <div class="log-cards-container" id="fuelLogList"></div>

        <div class="log-summary">
            <div>Xe ƒë√£ ch·∫°y : <span id="totalKm" class="result-value">0 km</span></div>
            <div>D·∫ßu ƒë√£ ƒë·ªï : <span id="totalLiters" class="result-value">0 L√≠t</span></div>
            <div style="border-top:1px dashed #999; margin-top:8px; padding-top:8px; color:var(--primary); font-weight:700; text-align:center">
                Ti√™u hao trung b√¨nh: <span id="avgCons" style="font-size:1.2em">0</span> L√≠t/100km
            </div>
        </div>
        <button class="save-btn" style="background:#555; width:100%; margin-top:15px; padding:12px" onclick="resetFuelMonth()">üóëÔ∏è Qua th√°ng m·ªõi (X√≥a h·∫øt)</button>

        <!-- T√çNH NHANH -->
        <div class="section-title" style="margin-top:25px">‚ö° T√çNH NHANH (D·ª∞ T√çNH)</div>
        <div class="input-group-calc">
          <label class="calc-label">M·ª©c kho√°n (l√≠t/100 km):</label>
          <input type="text" id="khoan" placeholder="VD: 14" inputmode="decimal" class="calc-input" onfocus="this.select()" min="0">
        </div>
        <div class="input-group-calc">
          <label class="calc-label">Qu√£ng ƒë∆∞·ªùng ƒë√£ ƒëi (km) :</label>
          <input type="text" id="km" placeholder="VD: 1000" inputmode="decimal" class="calc-input" onfocus="this.select()" min="0">
        </div>
        <div class="input-group-calc">
          <label class="calc-label">L∆∞·ª£ng d·∫ßu th·ª±c t·∫ø (l√≠t):</label>
          <input type="text" id="thuc" placeholder="VD: 130" inputmode="decimal" class="calc-input" onfocus="this.select()" min="0">
        </div>
        <div class="input-group-calc">
          <label class="calc-label">Gi√° d·∫ßu (VND/l√≠t):</label>
          <input type="text" id="gia" placeholder="VD: 19.000" inputmode="numeric" class="calc-input" onfocus="this.select()" oninput="formatInputMoney(this)" min="0">
        </div>
        <button class="calc-submit" onclick="tinhDau()">T√çNH K·∫æT QU·∫¢</button>
        <div id="resultDau" class="result-box-ot" style="display:none;"></div>
      </div>
    </div>
  </div>

  <!-- 6. T√çNH L∆Ø∆†NG & NH·∫¨T K√ù -->
  <div class="group">
    <div class="group-header" role="button" tabindex="0">
      <span class="title">üí∞ L∆∞∆°ng & Nh·∫≠t k√Ω tƒÉng ca</span><span class="arrow">‚ñ∂</span>
    </div>
    <div class="group-content">
      <div class="calc-content">
          <!-- C√ÄI ƒê·∫∂T L∆Ø∆†NG -->
          <div class="salary-row" id="otInputAnchor">
              <div class="salary-col">
                  <label class="calc-label">L∆∞∆°ng CB</label>
                  <input type="text" id="ot_luongCanBan" value="5.310.000" class="calc-input" inputmode="numeric" onfocus="this.select()" oninput="formatInputMoney(this)" min="0">
              </div>
              <div class="salary-col">
                  <label class="calc-label">Ng√†y c√¥ng</label>
                  <input type="text" id="ot_soNgayTrongThang" value="30" class="calc-input" inputmode="numeric" onfocus="this.select()" min="0">
              </div>
              <div class="salary-col">
                  <label class="calc-label">Ch·ªß nh·∫≠t</label>
                  <input type="text" id="ot_soNgayChuNhat" value="4" class="calc-input" inputmode="numeric" onfocus="this.select()" min="0">
              </div>
          </div>
          <button onclick="autoCalcSundays()" style="width:94%; max-width:580px; padding:9px; border-radius:8px; border:1px dashed var(--accent); background:rgba(25,136,69,0.07); color:var(--accent); font-size:13px; font-weight:700; cursor:pointer; margin-top:4px;">
              üìÖ T·ª± t√≠nh ng√†y c√¥ng & ch·ªß nh·∫≠t th√°ng n√†y
          </button>
          
          <!-- NH·∫¨T K√ù TƒÇNG CA -->
          <div class="section-title" style="margin-top:15px">üóì NH·∫¨T K√ù TƒÇNG CA (GHI S·ªî)</div>
          <div class="log-input-container">
             <div class="log-row-1">
                 <input type="date" id="otLogDate" class="log-input">
             </div>
             <div class="log-row-2">
                 <select id="otLogType" class="log-select">
                     <option value="1.5">TƒÉng ca th∆∞·ªùng</option>
                     <option value="2">TƒÉng ca OFF</option>
                 </select>
                 <input type="number" id="otLogHours" class="log-input" placeholder="S·ªë gi·ªù" inputmode="decimal" onfocus="this.select()" min="0">
             </div>
          </div>
          <button class="calc-submit" id="btnAddOT" onclick="addOTLog()">‚ûï Th√™m Nh·∫≠t K√Ω</button>
          <button class="calc-submit" id="btnCancelOT" onclick="cancelOTEdit()" style="background:#7f8c8d; display:none; margin-top:8px">H·ªßy S·ª≠a</button>

          <div class="log-cards-container" id="otLogList"></div>

          <div class="log-summary">
              <div>TƒÉng ca th∆∞·ªùng: <span id="sum15" class="result-value text-blue">0h</span> - <span id="money15" style="font-weight:bold">0ƒë</span></div>
              <div>TƒÉng ca .....OFF: <span id="sum20" class="result-value text-red">0h</span> - <span id="money20" style="font-weight:bold">0ƒë</span></div>
              <div class="result-item-total">
                  <span>T·ªîNG TI·ªÄN:</span>
                  <span class="big-number" id="sumMoney">0 VNƒê</span>
              </div>
              <div class="ot-note">K·∫øt qu·∫£ t·ª± ƒë·ªông t√≠nh theo L∆∞∆°ng C∆° b·∫£n, H√£y nh·∫≠p ƒë√∫ng s·ªë ng√†y c√¥ng, ng√†y ch·ªß nh·∫≠t c·ªßa th√°ng.<br>K·∫æT QU·∫¢ CH·ªà MANG T√çNH THAM KH·∫¢O.</div>
          </div>
          <button class="save-btn" style="background:#555; width:100%; margin-top:15px; padding:12px" onclick="resetOTMonth()">üóëÔ∏è Qua th√°ng m·ªõi (X√≥a h·∫øt)</button>

          <!-- T√çNH NHANH -->
          <div class="section-title" style="margin-top:25px">‚ö° T√çNH NHANH (D·ª∞ T√çNH)</div>
          <div class="input-group-calc">
              <label class="calc-label">T·ªïng Gi·ªù Th∆∞·ªùng (1.5x):</label>
              <input type="text" id="ot_gioTCTuong" placeholder="Nh·∫≠p gi·ªù..." inputmode="decimal" class="calc-input" onfocus="this.select()" min="0">
          </div>
          <div class="input-group-calc">
              <label class="calc-label">T·ªïng Gi·ªù OFF (2.0x):</label>
              <input type="text" id="ot_gioTCNghi" placeholder="Nh·∫≠p gi·ªù..." inputmode="decimal" class="calc-input" onfocus="this.select()" min="0">
          </div>
          <button onclick="tinhLuong()" class="calc-submit">T√çNH K·∫æT QU·∫¢</button>
          <div class="result-box-ot" id="ketQuaLuong" style="display:none;">
              <h3>üìä K·∫æT QU·∫¢</h3>
              <div style="display:flex; justify-content:space-between; margin:10px 0; padding-bottom:6px; border-bottom:1px dashed rgba(0,0,0,0.1)">
                  <span style="font-weight:600">L∆∞∆°ng/Gi·ªù:</span>
                  <span style="font-weight:700" id="luongGioCoBan">...</span>
              </div>
              <div style="display:flex; justify-content:space-between; margin:10px 0; padding-bottom:6px; border-bottom:1px dashed rgba(0,0,0,0.1)">
                  <span class="text-blue" style="font-weight:600">TC Th∆∞·ªùng:</span>
                  <span class="text-blue" style="font-weight:700" id="tienTCTuong">0 VNƒê</span>
              </div>
              <div style="display:flex; justify-content:space-between; margin:10px 0; padding-bottom:6px; border-bottom:1px dashed rgba(0,0,0,0.1)">
                  <span class="text-red" style="font-weight:600">TC OFF:</span>
                  <span class="text-red" style="font-weight:700" id="tienTCNghi">0 VNƒê</span>
              </div>
              <div class="result-item-total" style="border-top:2px solid #ff9788; padding-top:8px; margin-top:8px">
                  <span>T·ªîNG TI·ªÄN TƒÇNG CA:</span>
                  <span class="big-number" id="tongTienTangCa">0 VNƒê</span>
              </div>
              <div style="background:linear-gradient(135deg,#ff0033,#dd2476); padding:12px; border-radius:10px; margin-top:15px; color:#fff">
                  <div style="display:flex; justify-content:space-between; align-items:center; gap:8px; flex-wrap:nowrap">
                      <span style="font-weight:700; font-size:0.95em; white-space:nowrap">L∆Ø∆†NG T·∫†M T√çNH:</span>
                      <span style="font-weight:800; font-size:1.15em; white-space:nowrap" id="thucNhanTamTinh">0 VNƒê</span>
                  </div>
              </div>
              <div style="font-size:0.85em; font-style:italic; opacity:0.8; margin-top:12px; padding-top:10px; border-top:1px solid #ddd; text-align:center; line-height:1.4">
                  *L∆∞u √Ω: K·∫øt qu·∫£ ch·ªâ tham kh·∫£o ƒë·ªëi so√°t. L∆∞∆°ng th·ª±c t·∫ø ph·ª• thu·ªôc ng√†y c√¥ng, th∆∞·ªüng, ph·∫°t ho·∫∑c thu·∫ø TNCN. ƒê√£ kh·∫•u tr·ª´ ti·ªÅn ƒë√≥ng BHXH 557.550 VNƒê
              </div>
          </div>
      </div>
    </div>
  </div>

  <!-- 7. TI·ªÜN √çCH GOM NH√ìM -->
  <div class="group">
    <div class="group-header" role="button" tabindex="0">
      <span class="title">üß© Ti·ªán √≠ch kh√°c</span><span class="arrow">‚ñ∂</span>
    </div>
    <div class="group-content">
        
      <!-- S·ªî TAY T√ÄI X·∫æ -->
      <div class="section-title" style="margin-top:0">üìù S·ªî TAY T√ÄI X·∫æ</div>
      <div class="calc-content" style="padding:0">
        <textarea id="myNote" class="note-area" placeholder="Ghi ch√∫ nhanh: ODO thay nh·ªõt, Ti·ªÅn n·ª£, S·ª± vi·ªác... (L∆∞u tr√™n m√°y)"></textarea>
        <div style="display:flex; justify-content:flex-end; padding:0 10px 10px;">
          <button class="save-btn" onclick="if(confirm('X√≥a h·∫øt ghi ch√∫?')){document.getElementById('myNote').value='';localStorage.removeItem('userNote');}">X√≥a tr·∫Øng</button>
        </div>
      </div>

      <!-- NH·∫ÆC L·ªäCH XE (STYLE N√ÇNG C·∫§P CHUY√äN NGHI·ªÜP) -->
      <div class="section-title">üîî QU·∫¢N L√ù & NH·∫ÆC L·ªäCH XE</div>
      <div class="calc-content" style="padding:0">
          
          <!-- ƒêƒÉng ki·ªÉm -->
          <div class="reminder-compact-row" id="rowRegistry">
              <div class="reminder-info">
                  <span class="reminder-label-main">üìÖ ƒêƒÉng ki·ªÉm</span>
                  <span class="reminder-status-text" id="textRegistry">ƒêang t·∫£i...</span>
              </div>
              <button class="btn-edit-toggle" onclick="toggleEdit('editRegistry', this)">S·ª≠a</button>
          </div>
          <div class="edit-area" id="editRegistry">
              <label class="calc-label" style="font-size:14px; margin-bottom:8px;">C·∫≠p nh·∫≠t ng√†y h·∫øt h·∫°n:</label>
              <input type="date" id="dateRegistry" class="reminder-input-pro" onchange="saveReminders()">
          </div>

          <!-- B·∫£o hi·ªÉm -->
          <div class="reminder-compact-row" id="rowInsurance">
              <div class="reminder-info">
                  <span class="reminder-label-main">üõ°Ô∏è B·∫£o hi·ªÉm TNDS</span>
                  <span class="reminder-status-text" id="textInsurance">ƒêang t·∫£i...</span>
              </div>
              <button class="btn-edit-toggle" onclick="toggleEdit('editInsurance', this)">S·ª≠a</button>
          </div>
          <div class="edit-area" id="editInsurance">
              <label class="calc-label" style="font-size:14px; margin-bottom:8px;">C·∫≠p nh·∫≠t ng√†y h·∫øt h·∫°n:</label>
              <input type="date" id="dateInsurance" class="reminder-input-pro" onchange="saveReminders()">
          </div>

          <!-- Thay nh·ªõt -->
          <div class="reminder-compact-row" id="rowMaintenance">
              <div class="reminder-info">
                  <span class="reminder-label-main">üîß Thay nh·ªõt (Theo ODO)</span>
                  <span class="reminder-status-text" id="textMaintenance">ƒêang t·∫£i...</span>
              </div>
              <button class="btn-edit-toggle" onclick="toggleEdit('editMaintenance', this)">S·ª≠a</button>
          </div>
          <div class="edit-area" id="editMaintenance">
              <label class="calc-label" style="font-size:14px; margin-bottom:8px;">M·ªëc ODO c·∫ßn thay ti·∫øp theo:</label>
              <input type="number" id="odoMaintenance" class="reminder-input-pro" placeholder="VD: 55000" oninput="saveReminders()">
              <div style="font-size: 12px; margin-top:8px; opacity:0.8; font-style:italic;">* App l·∫•y ODO t·ª´ Nh·∫≠t k√Ω d·∫ßu ƒë·ªÉ nh·∫Øc anh em.</div>
          </div>

          <!-- G·ª£i √Ω b·∫£o d∆∞·ª°ng xe -->
          <div class="expert-advice-box" id="expertAdvice">
              üí° <b>L∆∞u √Ω cho anh em:</b> ƒêang ph√¢n t√≠ch ODO...
          </div>

          <!-- B·∫¢NG TRA C·ª®U H√ÄNG NGANG -->
          <div class="maintenance-header-row">
              <span class="maintenance-title">M·ªëc b·∫£o d∆∞·ª°ng quan tr·ªçng</span>
              <button class="btn-lookup-toggle" id="btnShowLookup" onclick="toggleMaintenanceTable()">Xem</button>
          </div>

          <table class="maintenance-table" id="maintenanceTable">
              <thead>
                  <tr>
                      <th>C·∫•p / ODO</th>
                      <th>N·ªôi dung tham kh·∫£o</th>
                  </tr>
              </thead>
              <tbody>
                  <tr>
                      <td><span class="m-cap">L·∫ßn ƒë·∫ßu</span><span class="m-odo">3k - 5k km</span></td>
                      <td>Thay nh·ªõt & L·ªçc m√°y. N√™n b√°o x∆∞·ªüng <b>si·∫øt l·∫°i g·∫ßm & cabin</b> cho ch·∫Øc ch·∫Øn.</td>
                  </tr>
                  <tr>
                      <td><span class="m-cap">C·∫•p Nh·ªè</span><span class="m-odo">M·ªói 10.000km</span></td>
                      <td>Thay nh·ªõt m√°y + L·ªçc nh·ªõt. V·ªá sinh l·ªçc gi√≥. <b>Ki·ªÉm tra m√° phanh (th·∫Øng).</b></td>
                  </tr>
                  <tr>
                      <td><span class="m-cap">C·∫•p Trung</span><span class="m-odo">M·ªói 20.000km</span></td>
                      <td><b>Thay L·ªçc D·∫ßu</b>. V·ªá sinh th·∫Øng 4 b√°nh. B∆°m m·ª° g·∫ßm.</td>
                  </tr>
                  <tr>
                      <td><span class="m-cap">C·∫•p L·ªõn 1</span><span class="m-odo">M·ªói 40.000km</span></td>
                      <td>Thay d·∫ßu H·ªôp s·ªë, d·∫ßu C·∫ßu, N∆∞·ªõc l√†m m√°t. Thay d·∫ßu Phanh & Tr·ª£ l·ª±c l√°i.</td>
                  </tr>
                  <tr>
                      <td><span class="m-cap">C·∫•p L·ªõn 2</span><span class="m-odo">M·ªói 80.000km</span></td>
                      <td>Thay d√¢y Curoa t·ªïng. Thay nh·ªõt moay-∆°. V·ªá sinh kim phun & h·ªçng n·∫°p.</td>
                  </tr>
                  <tr>
                      <td><span class="m-cap">T·ªïng qu√°t</span><span class="m-odo">> 100.000km</span></td>
                      <td>Ki·ªÉm tra h·ªá th·ªëng C√¥n (Ly h·ª£p), r∆° th∆∞·ªõc l√°i v√† nh√≠p / gi·∫£m ch·∫•n g·∫ßm.</td>
                  </tr>
              </tbody>
          </table>
      </div>

      <!-- SAO L∆ØU D·ªÆ LI·ªÜU (M·ªöI - PRO VERSION) -->
      <div class="section-title">üíæ SAO L∆ØU D·ªÆ LI·ªÜU</div>
      <div class="backup-container">
          <div class="backup-description">
              <p style="margin:0 0 8px 0; font-size:0.95em; line-height:1.5;">
                  <strong>üì¶ Sao l∆∞u to√†n b·ªô:</strong> Nh·∫≠t k√Ω d·∫ßu, tƒÉng ca, ghi ch√∫, l·ªãch xe
              </p>
              <p style="margin:0; font-size:0.85em; opacity:0.85; line-height:1.4;">
                  Ph√≤ng tr∆∞·ªùng h·ª£p ƒë·ªïi m√°y, x√≥a cache ho·∫∑c c√†i ƒë·∫∑t l·∫°i tr√¨nh duy·ªát
              </p>
          </div>
          
          <div class="backup-buttons">
              <button class="backup-btn backup-export" onclick="exportBackup()">
                  üì§ Xu·∫•t m√£
              </button>
              <button class="backup-btn backup-import" onclick="importBackup()">
                  üì• Nh·∫≠p m√£
              </button>
          </div>
          
          <div class="backup-guide">
              <div class="guide-step">
                  <span class="step-number">1Ô∏è‚É£</span>
                  <span class="step-text"><strong>Xu·∫•t m√£:</strong> B·∫•m "üì§ Xu·∫•t m√£" ‚Üí Sao ch√©p ƒëo·∫°n m√£ ‚Üí L∆∞u v√†o Notepad ho·∫∑c g·ª≠i cho m√¨nh qua Zalo</span>
              </div>
              <div class="guide-step">
                  <span class="step-number">2Ô∏è‚É£</span>
                  <span class="step-text"><strong>Nh·∫≠p m√£:</strong> B·∫•m "üì• Nh·∫≠p m√£" ‚Üí D√°n ƒëo·∫°n m√£ ƒë√£ l∆∞u ‚Üí X√°c nh·∫≠n ‚Üí D·ªØ li·ªáu kh√¥i ph·ª•c!</span>
              </div>
              <div class="guide-note">
                  üí° <strong>M·∫πo:</strong> N√™n sao l∆∞u tr∆∞·ªõc khi ƒë·ªïi m√°y ho·∫∑c d·ªçn r√°c ƒëi·ªán tho·∫°i  ƒë·ªÉ ƒë·∫£m b·∫£o d·ªØ li·ªáu an to√†n
              </div>
          </div>
      </div>

      <!-- T·∫¢I APP -->
      <div class="section-title">üì± T·∫¢I APP NHI·ªÜM V·ª§ (VnDriver)</div>
      <a class="link-card" href="https://drive.google.com/file/d/1F5Ln5qr86FPn5zybBKha72jKkFyEVwKB/view?usp=drivesdk" target="_blank" rel="noopener noreferrer"><div class="link-left">T·∫£i App Android (APK)</div></a>
      <a class="link-card" href="https://testflight.apple.com/join/ngwb0Mpe" target="_blank" rel="noopener noreferrer"><div class="link-left">T·∫£i App iOS (TestFlight)</div></a>

      <!-- D·ªäCH V·ª§ C√îNG -->
      <div class="section-title">üö¶ D·ªäCH V·ª§ C√îNG TR·ª∞C TUY·∫æN</div>
      <a class="link-card" href="https://www.csgt.vn/tra-cuu-phuong-tien-vi-pham.html" target="_blank" rel="noopener noreferrer"><div class="link-left">üö® Tra c·ª©u Ph·∫°t Ngu·ªôi (C·ª•c CSGT)</div></a>
      <a class="link-card" href="https://dichvucong.gov.vn/p/home/dvc-thanh-toan-vi-pham-giao-thong.html" target="_blank" rel="noopener noreferrer"><div class="link-left">üí∏ N·ªôp ph·∫°t Vi ph·∫°m giao th√¥ng</div></a>
      <a class="link-card" href="https://dvc4.gplx.gov.vn/p/home/dvc-trang-chu.html" target="_blank" rel="noopener noreferrer"><div class="link-left">üÜî ƒê·ªïi Gi·∫•y ph√©p l√°i xe Online</div></a>

    </div>
  </div>
 
    <!-- 9. GI·ªöI THI·ªÜU & H·ªñ TR·ª¢ (ƒê√É KH√îI PH·ª§C 100% B·∫¢N G·ªêC) -->
  <div class="group">
    <div class="group-header" role="button" tabindex="0">
      <span class="title">‚ÑπÔ∏è Gi·ªõi thi·ªáu</span><span class="arrow">‚ñ∂</span>
    </div>
    <div class="group-content">
        <div class="intro-box">
            <b>Link T√†i X·∫ø J&T Express</b> l√† ·ª©ng d·ª•ng web mi·ªÖn ph√≠, ƒë∆∞·ª£c ph√°t tri·ªÉn b·ªüi <b>L√™ T·ªânh</b> nh·∫±m h·ªó tr·ª£ anh em t√†i x·∫ø trong c√¥ng vi·ªác h√†ng ng√†y.
            <br><br>
            <b>C√°c t√≠nh nƒÉng ch√≠nh:</b>
            <ul style="padding-left:20px; margin:5px 0;">
                <li><b>T·ªïng h·ª£p Link & Zalo:</b> Gom t·∫•t c·∫£ c√°c nh√≥m Zalo, link b√°o c√°o, SƒêT ƒëi·ªÅu ph·ªëi v·ªÅ m·ªôt n∆°i, kh√¥ng c·∫ßn t√¨m ki·∫øm.</li>
                <li><b>T√≠nh l∆∞∆°ng tƒÉng ca:</b> T·ª± ƒë·ªông quy ƒë·ªïi gi·ªù ra ti·ªÅn ch√≠nh x√°c.</li>
                <li><b>Nh·∫≠t k√Ω v·∫≠n h√†nh:</b> Ghi ch√©p ODO, t√≠nh ƒë·ªãnh m·ª©c d·∫ßu.</li>
                <li><b>Tra c·ª©u nhanh:</b> Link n·ªôp ph·∫°t, tra c·ª©u ph·∫°t ngu·ªôi...nh·∫Øc l·ªãch b·∫£o d∆∞·ª°ng, h·∫°n ƒëƒÉng ki·ªÉm...</li>
            </ul>
            <div style="border-top:1px dashed #ccc; margin:10px 0; padding-top:10px;">
                <b>üí° M·∫∏O S·ª¨ D·ª§NG HI·ªÜU QU·∫¢:</b><br>
                1. <b>C√†i ƒë·∫∑t:</b> N√™n d√πng <b>Google Chrome</b> -> Ch·ªçn "Th√™m v√†o m√†n h√¨nh ch√≠nh" ƒë·ªÉ d√πng nh∆∞ App.<br>
                2. <b>T√≠nh D·∫ßu:</b> "ODO Ch·ªët" l√† ODO t·∫°i c√¢y xƒÉng l·∫ßn ƒë·ªï cu·ªëi c√πng c·ªßa th√°ng tr∆∞·ªõc. Nh·∫≠p 1 l·∫ßn ƒë·∫ßu th√°ng r·ªìi b·∫•m L∆∞u.<br>
                3. <b>T√≠nh L∆∞∆°ng:</b> M·ªói th√°ng nh·ªõ s·ª≠a l·∫°i √¥ <b>"Ng√†y c√¥ng"</b> v√† <b>"Ch·ªß nh·∫≠t"</b> (VD: Th√°ng 2 c√≥ 28 ng√†y v√† 4 ng√†y ch·ªß nh·∫≠t th√¨ s·ª≠a l·∫°i nh√©) ƒë·ªÉ t√≠nh ti·ªÅn ch√≠nh x√°c.<br>
                4. <b>Chia s·∫ª:</b> Th·∫•y ti·ªán th√¨ chia s·∫ª Link cho anh em ƒë·ªìng ƒë·ªôi c√πng d√πng nh√©! ƒê·∫∑c bi·ªát v·ªõi anh em t√†i x·∫ø m·ªõi.
            </div>
        </div>
        
        <!-- QR CODE & CHIA S·∫∫ -->
        <div class="qr-container">
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://letinhclover.github.io/jntdriver" alt="QR Code" class="qr-img">
            <br>
            <button class="share-btn-native" onclick="shareApp()">
                üì§ Chia s·∫ª cho ƒë·ªìng ƒë·ªôi
            </button>
        </div>

        <div class="author-box">
            <p>M·ªçi √Ω ki·∫øn ƒë√≥ng g√≥p ho·∫∑c c·∫ßn h·ªó tr·ª£ c√°ch s·ª≠ d·ª•ng,<br>anh em c·ª© nh·∫Øn tin trong nh√≥m Zalo nh√©.</p>
            <a href="https://zalo.me/g/lgwxjz988" target="_blank" rel="noopener noreferrer" class="contact-btn" style="height:auto; width:fit-content; margin:10px auto; padding:8px 20px;">
                <span style="font-weight:bold; color:var(--blue-text)">üí¨ Nh·∫Øn tin cho L√™ T·ªânh</span>
            </a>
        </div>
    </div>
  </div>

</main>

<footer>
  <div class="footer-text">Trang n√†y ch·ªâ d√†nh cho n·ªôi b·ªô t√†i x·∫ø J&T</div>
  <div class="visitor-count" id="visitCount">ƒêang t·∫£i l∆∞·ª£t truy c·∫≠p...</div>
  <div style="margin-top:4px;">
    ¬© 2026 <a href="https://zalo.me/g/lgwxjz988" class="footer-link" rel="noopener noreferrer">L√™ T·ªânh</a>
  </div>
</footer>

<!-- TOAST -->
<div id="toast">Th√¥ng b√°o</div>

<script>
// --- H√ÄM HI·ªÇN TH·ªä TOAST ---
function showToast(message) {
    var x = document.getElementById("toast");
    x.innerText = message;
    x.className = "show";
    setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
}

// --- H√ÄM CU·ªòN TRANG M·ªöI ---
function scrollToElement(id) {
    const el = document.getElementById(id);
    if(el) {
        el.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}

// --- H·ª¶Y ƒêƒÇNG K√ù SERVICE WORKER (ƒê·∫£m b·∫£o t·∫£i m√£ m·ªõi nh·∫•t) ---
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then(function(registrations) {
        for(let registration of registrations) {
            registration.unregister();
        }
    });
}

// --- H√ÄM L·∫§Y NG√ÄY HI·ªÜN T·∫†I ---
function setToday(elementId) {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    const todayStr = `${year}-${month}-${day}`;
    const el = document.getElementById(elementId);
    if(el && !el.value) el.value = todayStr;
}

// --- ƒê·ªäNH D·∫†NG TI·ªÄN ---
function formatInputMoney(el) {
    let val = el.value.replace(/\D/g, ''); 
    if(val === '') { el.value = ''; return; }
    el.value = Number(val).toLocaleString('vi-VN');
}

function parseMoney(id) {
    let val = document.getElementById(id).value;
    return parseFloat(val.replace(/\./g, '').replace(/,/g, '.')) || 0;
}

function parseHours(id) {
    let val = document.getElementById(id).value;
    return parseFloat(val.replace(/,/g, '.')) || 0;
}

// --- AUTO SAVE SALARY SETTINGS ---
const salaryFields = ['ot_luongCanBan', 'ot_soNgayTrongThang', 'ot_soNgayChuNhat'];
function loadSalarySettings() {
    salaryFields.forEach(id => {
        const saved = localStorage.getItem(id);
        if (saved) {
            const el = document.getElementById(id);
            el.value = saved;
            if(id === 'ot_luongCanBan') formatInputMoney(el);
        }
    });
}
function saveSalarySettings() {
    salaryFields.forEach(id => {
        const val = document.getElementById(id).value;
        localStorage.setItem(id, val);
    });
    reCalcSalaryAuto();
}
salaryFields.forEach(id => {
    document.getElementById(id).addEventListener('input', saveSalarySettings);
});

// --- MAPS DATA ---
const googleMapsData = [
    { code: 'GW0', address: 'Kho 1, L√¥ TT1, QL22, KCN T√¢n Ph√∫ Trung, C·ªß Chi', link: 'https://maps.app.goo.gl/8ue4xcmMdxwMS5uX9', type: 'GW' },
    { code: 'GW3', address: '1103 QL1A, B√¨nh Tr·ªã ƒê√¥ng A, B√¨nh T√¢n', link: 'https://maps.app.goo.gl/qdCVdF9DygSqSWin7', type: 'GW' },
    { code: 'GW4', address: 'QL22, T√¢n Ph√∫ Trung, C·ªß Chi (Kho GHTK c≈©)', link: 'https://maps.app.goo.gl/c5A8ZNvydTkjeC7LA', type: 'GW' },
    { code: 'GW5', address: 'L√¥ J, ƒê∆∞·ªùng N6, KCN L√™ Minh Xu√¢n 3, B√¨nh Ch√°nh', link: 'https://maps.app.goo.gl/LZme5LnDZiw1obNU9', type: 'GW' },
    { code: 'GW6', address: 'L√¥ 3D-8, ƒê∆∞·ªùng 12, KCN Long H·∫≠u 3, C·∫ßn Giu·ªôc', link: 'https://maps.app.goo.gl/EZte1BU8pfAkQdUv9', type: 'GW' },
    { code: 'H81', address: '21 ƒê∆∞·ªùng ·ª§ Ghe, Th·ªß ƒê·ª©c', link: 'https://goo.gl/maps/hxigDoxuf2rMm1s78', type: 'HUB' },
    { code: 'H82', address: '17/6A Phan Huy √çch, G√≤ V·∫•p', link: 'https://maps.app.goo.gl/LF6n2nSBkwVmg1h5A', type: 'HUB' },
    { code: 'H83', address: '4 ƒê√†o Tr√≠, KP5, Ph√∫ Thu·∫≠n, Q7', link: 'https://maps.app.goo.gl/7NX3CjqeSju77DRt6', type: 'HUB' },
    { code: 'H85', address: 'S·ªë 9 Th·∫°nh L·ªôc 08, Q12', link: 'https://maps.app.goo.gl/Luaguf3a7NeSFvCs7', type: 'HUB' },
    { code: 'H86', address: '722 √Çu C∆°, T√¢n B√¨nh', link: 'https://maps.app.goo.gl/bbMaJPQytnaeQgNp8', type: 'HUB' },
    { code: 'H87', address: 'Kho SoTrans KM7-9 Xa L·ªô H√† N·ªôi, Th·ªß ƒê·ª©c', link: 'https://maps.app.goo.gl/Eig83EZtiGpY7vgY9', type: 'HUB' },
    { code: 'H88', address: 'QJFG+35H T√¢n Ph√∫, Th√†nh ph·ªë H·ªì Ch√≠ Minh', link: 'https://goo.gl/maps/Q5CN4htdgjgYttim6', type: 'HUB' },
    { code: 'H89', address: '874/51 T√¢n K·ª≥ T√¢n Qu√Ω, B√¨nh H∆∞ng H√≤a', link: 'https://maps.app.goo.gl/SjSMrEcVJGqnLzo76', type: 'HUB' },
    { code: 'H91', address: '285 N∆° Trang Long, B√¨nh Th·∫°nh', link: 'https://maps.app.goo.gl/uHE7xqVq4bTpQ4C37', type: 'HUB' },
    { code: 'H93', address: '4 ƒê√†o Tr√≠, Q7', link: 'https://maps.app.goo.gl/7NX3CjqeSju77DRt6', type: 'HUB' },
    { code: 'H96', address: 'L√¥ B26, C·ª•m CN Xu√¢n Th·ªõi S∆°n, H√≥c M√¥n', link: 'https://maps.app.goo.gl/om59mKEP1Z1u4PY36', type: 'HUB' },
    { code: 'H98', address: '1185 L√™ ƒê·ª©c Anh, B√¨nh T√¢n', link: 'https://maps.app.goo.gl/543EgfyuHcYiqA12A', type: 'HUB' },
    { code: 'LAZADA', address: '2-4 ƒê∆∞·ªùng M14, B√¨nh H∆∞ng Ho√†, B√¨nh T√¢n', link: 'https://maps.app.goo.gl/eAuwRatRFPKh56at6', type: 'HUB' },
    { code: 'TOPGIA', address: '581 T·ªânh L·ªô 2, Trung L·∫≠p H·∫°, C·ªß Chi', link: 'https://goo.gl/maps/mwE8pJGfhDZqB9Bf8', type: 'HUB' },
];

function generateMapLinks() {
    const container = document.getElementById('mapListContainer');
    if (!container) return;
    const gws = googleMapsData.filter(x => x.type === 'GW');
    const hubs = googleMapsData.filter(x => x.type !== 'GW');
    let html = '';
    html += gws.map(item => `<a class="link-card" href="${item.link}" target="_blank" rel="noopener noreferrer"><div class="link-left"><strong>${item.code}</strong><br><span style="font-size: 0.9em; opacity: 0.8;">${item.address}</span></div><span style="color: var(--primary);">üìç</span></a>`).join('');
    html += `<div style="border-top: 1px dashed #ccc; margin: 10px 15px;"></div>`;
    html += hubs.map(item => `<a class="link-card" href="${item.link}" target="_blank" rel="noopener noreferrer"><div class="link-left"><strong>${item.code}</strong><br><span style="font-size: 0.9em; opacity: 0.8;">${item.address}</span></div><span style="color: var(--primary);">üìç</span></a>`).join('');
    container.innerHTML = html;
}
generateMapLinks();

// --- THEME & ACCORDION ---
const btnTheme = document.getElementById('toggleTheme');
const body = document.body;
function applyTheme(isDark) {
    if (isDark) { body.classList.add('dark'); btnTheme.textContent = '‚òÄÔ∏è'; }
    else { body.classList.remove('dark'); btnTheme.textContent = 'üåô'; }
}
const savedTheme = localStorage.getItem('theme');
if (savedTheme === 'dark') applyTheme(true);
else applyTheme(false); // M·∫∑c ƒë·ªãnh S√ÅNG n·∫øu ch∆∞a ch·ªçn, kh√¥ng auto theo h·ªá th·ªëng

btnTheme.onclick = () => {
    const isDark = !body.classList.contains('dark');
    applyTheme(isDark);
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
};

document.querySelectorAll('.group-header').forEach(header => {
    header.addEventListener('click', () => {
        const currentGroup = header.parentElement;
        const isOpen = currentGroup.classList.contains('open');
        document.querySelectorAll('.group').forEach(group => { if (group !== currentGroup) group.classList.remove('open'); });
        if (isOpen) currentGroup.classList.remove('open'); else currentGroup.classList.add('open');
    });
});

// --- S·ªî TAY ---
const noteArea = document.getElementById('myNote');
if(localStorage.getItem('userNote')) noteArea.value = localStorage.getItem('userNote');
noteArea.addEventListener('input', () => localStorage.setItem('userNote', noteArea.value));

// --- SAO L∆ØU & KH√îI PH·ª§C D·ªÆ LI·ªÜU (PRO VERSION) ---
function exportBackup() {
    try {
        // Gom to√†n b·ªô localStorage th√†nh object
        const backupData = {
            fuelLogs: localStorage.getItem('fuelLogs'),
            otLogs: localStorage.getItem('otLogs'),
            closingOdo: localStorage.getItem('closingOdo'),
            ot_luongCanBan: localStorage.getItem('ot_luongCanBan'),
            ot_soNgayTrongThang: localStorage.getItem('ot_soNgayTrongThang'),
            ot_soNgayChuNhat: localStorage.getItem('ot_soNgayChuNhat'),
            dateRegistry: localStorage.getItem('dateRegistry'),
            dateInsurance: localStorage.getItem('dateInsurance'),
            odoMaintenance: localStorage.getItem('odoMaintenance'),
            userNote: localStorage.getItem('userNote'),
            theme: localStorage.getItem('theme')
        };
        // Chuy·ªÉn th√†nh JSON
        const jsonString = JSON.stringify(backupData);
        // M√£ h√≥a Base64
        const base64Code = btoa(unescape(encodeURIComponent(jsonString)));
        // Copy v√†o clipboard
        const tempInput = document.createElement("textarea");
        tempInput.value = base64Code;
        document.body.appendChild(tempInput);
        tempInput.select();
        document.execCommand("copy");
        document.body.removeChild(tempInput);
        showToast("‚úÖ ƒê√£ sao ch√©p m√£ sao l∆∞u v√†o m√°y!");
    } catch(e) {
        alert("L·ªói khi xu·∫•t d·ªØ li·ªáu: " + e.message);
    }
}

function importBackup() {
    try {
        const code = prompt("D√°n m√£ sao l∆∞u v√†o ƒë√¢y:");
        if (!code) return;
        // Gi·∫£i m√£ Base64
        const jsonString = decodeURIComponent(escape(atob(code.trim())));
        const backupData = JSON.parse(jsonString);
        // N·∫°p l·∫°i v√†o localStorage
        Object.keys(backupData).forEach(key => {
            if (backupData[key] !== null && backupData[key] !== undefined) {
                localStorage.setItem(key, backupData[key]);
            }
        });
        showToast("‚úÖ ƒê√£ kh√¥i ph·ª•c d·ªØ li·ªáu!");
        setTimeout(() => location.reload(), 1500);
    } catch(e) {
        alert("M√£ sao l∆∞u kh√¥ng h·ª£p l·ªá ho·∫∑c b·ªã l·ªói: " + e.message);
    }
}

// --- T√çNH D·∫¶U ---
const fmt = (n) => parseFloat(n.toFixed(2));
function formatMoney(n) { return Math.round(n).toLocaleString('vi-VN') + ' VNƒê'; }

window.tinhDau = function() {
  const khoan = parseMoney('khoan');
  const km = parseMoney('km');
  const thuc = parseMoney('thuc');
  const gia = parseMoney('gia');
  const resultDiv = document.getElementById('resultDau');
  resultDiv.style.display = 'block';
  if (km <= 0) { resultDiv.innerHTML = '<b style="color:var(--primary);">‚ö†Ô∏è Nh·∫≠p Qu√£ng ƒë∆∞·ªùng (>0).</b>'; return; }
  const tieuhao = (thuc / km) * 100;
  let html = `<div class="result-item"><span>M·ª©c kho√°n:</span><span class="result-value">${fmt(khoan)} L√≠t</span></div>`;
  html += `<div class="result-item"><span>Qu√£ng ƒë∆∞·ªùng:</span><span class="result-value">${fmt(km)} km</span></div>`;
  if (khoan > 0) {
    const dauKhoan = (km * khoan) / 100;
    const chenhlech = dauKhoan - thuc;
    html += `<div class="result-item"><span>Th·ª±c t·∫ø:</span><span class="result-value">${fmt(thuc)} L√≠t</span></div>`;
    html += `<div class="result-item"><span>Ti√™u hao TB:</span><span class="result-value">${fmt(tieuhao)} L/100km</span></div>`;
    let msgClass = chenhlech >= 0 ? 'color:var(--accent)' : 'color:var(--primary)';
    let msgText = chenhlech >= 0 ? `D∆Ø ${fmt(chenhlech)} L√çT` : `THI·∫æU ${fmt(Math.abs(chenhlech))} L√çT`;
    let moneyText = '';
    if(gia > 0) {
        moneyText = formatMoney(Math.abs(chenhlech * gia));
        if(chenhlech >= 0) moneyText = "(+" + moneyText + ")"; else moneyText = "(-" + moneyText + ")";
    }
    html += `<div class="result-item-total" style="${msgClass}"><span>${msgText}</span><span>${moneyText}</span></div>`;
  } else {
      html += `<div class="result-item"><span>Ti√™u hao TB:</span><span class="result-value">${fmt(tieuhao)} L/100km</span></div>`;
  }
  resultDiv.innerHTML = html;
}

// --- NH·∫¨T K√ù D·∫¶U ---
setToday('logDate');
let closingOdo = parseFloat(localStorage.getItem('closingOdo')) || 0;
if(closingOdo > 0) {
    document.getElementById('closingOdo').value = closingOdo;
    document.getElementById('savedOdoText').innerText = "ƒê√£ l∆∞u ODO ch·ªët: " + closingOdo;
}
let fuelLogs = [];
try { fuelLogs = JSON.parse(localStorage.getItem('fuelLogs')) || []; } catch(e) { fuelLogs = []; localStorage.removeItem('fuelLogs'); }
let editFuelIndex = -1;

function saveClosingOdo() {
    const val = parseFloat(document.getElementById('closingOdo').value);
    if(!isNaN(val) && val > 0) {
        localStorage.setItem('closingOdo', val);
        closingOdo = val;
        document.getElementById('savedOdoText').innerText = "ƒê√£ l∆∞u ODO ch·ªët: " + val;
        showToast("ƒê√£ l∆∞u ODO ch·ªët!");
        renderLogs(); 
    }
}
function addFuelLog() {
    if(closingOdo === 0) { alert("L∆∞u ODO Ch·ªët tr∆∞·ªõc!"); return; }
    const date = document.getElementById('logDate').value;
    const liters = parseFloat(document.getElementById('logLiters').value);
    const currentOdo = parseFloat(document.getElementById('logOdo').value);
    if(!date || isNaN(liters) || isNaN(currentOdo)) { alert("Nh·∫≠p ƒë·ªß th√¥ng tin!"); return; }
    if(liters <= 0) { alert("S·ªë l√≠t ph·∫£i l·ªõn h∆°n 0!"); return; }
    if(currentOdo <= closingOdo) { alert("ODO hi·ªán t·∫°i ph·∫£i l·ªõn h∆°n ODO ch·ªët!"); return; }
    if(editFuelIndex > -1) {
        fuelLogs[editFuelIndex] = { date, liters, odo: currentOdo };
        cancelFuelEdit();
        showToast("‚úÖ ƒê√£ c·∫≠p nh·∫≠t nh·∫≠t k√Ω d·∫ßu!");
    } else {
        fuelLogs.push({ date, liters, odo: currentOdo });
        showToast("‚úÖ ƒê√£ th√™m nh·∫≠t k√Ω d·∫ßu!");
    }
    saveAndRender();
    document.getElementById('logLiters').value = '';
    document.getElementById('logOdo').value = '';
}
function editFuelLog(index) {
    editFuelIndex = index;
    const log = fuelLogs[index];
    document.getElementById('logDate').value = log.date;
    document.getElementById('logLiters').value = log.liters;
    document.getElementById('logOdo').value = log.odo;
    document.getElementById('btnAddFuel').innerText = "üíæ C·∫≠p nh·∫≠t";
    document.getElementById('btnAddFuel').classList.add('btn-update');
    document.getElementById('btnCancelFuel').style.display = "inline-block";
    scrollToElement('fuelInputAnchor');
}
function cancelFuelEdit() {
    editFuelIndex = -1;
    document.getElementById('btnAddFuel').innerText = "‚ûï Th√™m Nh·∫≠t K√Ω";
    document.getElementById('btnAddFuel').classList.remove('btn-update');
    document.getElementById('btnCancelFuel').style.display = "none";
}
function saveAndRender() { localStorage.setItem('fuelLogs', JSON.stringify(fuelLogs)); renderLogs(); calcReminders(); }
function resetFuelMonth() { 
    if(window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a h·∫øt nh·∫≠t k√Ω d·∫ßu th√°ng n√†y kh√¥ng?")) { 
        fuelLogs = []; 
        saveAndRender(); 
        showToast("üóëÔ∏è ƒê√£ x√≥a nh·∫≠t k√Ω d·∫ßu th√°ng n√†y!");
    }
}

function resetOTMonth() { 
    if(window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a h·∫øt nh·∫≠t k√Ω tƒÉng ca th√°ng n√†y kh√¥ng?")) { 
        otLogs = []; 
        saveAndRenderOT(); 
        showToast("üóëÔ∏è ƒê√£ x√≥a nh·∫≠t k√Ω tƒÉng ca th√°ng n√†y!");
    }
}

function renderLogs() {
    const container = document.getElementById('fuelLogList');
    container.innerHTML = '';
    let totalLiters = 0, totalKm = 0, prev = closingOdo;
    const sorted = [...fuelLogs].sort((a,b) => a.odo - b.odo);

    if (sorted.length === 0) {
        container.innerHTML = `<div class="log-empty-state">Ch∆∞a c√≥ nh·∫≠t k√Ω d·∫ßu n√†o</div>`;
    } else {
        // Th√™m header row
        const header = document.createElement('div');
        header.className = 'fuel-log-header';
        header.innerHTML = `
            <div>Ng√†y</div>
            <div>L√≠t</div>
            <div>ODO</div>
            <div>Km</div>
            <div>L/100</div>
            <div>S·ª≠a/X√≥a</div>
        `;
        container.appendChild(header);
        
        sorted.forEach((log, i) => {
            let dist = log.odo - prev;
            let cons = dist > 0 ? (log.liters / dist) * 100 : 0;
            totalLiters += log.liters; totalKm += dist;
            const d = log.date.split('-');
            const shortDate = `${d[2]}/${d[1]}`;
            
            const card = document.createElement('div');
            card.className = 'log-card-fuel';
            card.innerHTML = `
                <div class="fuel-date">${shortDate}</div>
                <div>${fmt(log.liters)}</div>
                <div style="font-weight:600">${log.odo}</div>
                <div style="color:var(--primary); font-weight:600">${dist}</div>
                <div>${cons > 0 ? cons.toFixed(1) : '-'}</div>
                <div class="fuel-actions">
                    <button class="log-action-btn btn-edit" onclick="editFuelLog(${i})" style="font-size:15px">‚úé</button>
                    <button class="log-action-btn btn-del" onclick="deleteFuelLog(${i})" style="font-size:16px">‚úò</button>
                </div>
            `;
            container.appendChild(card);
            prev = log.odo;
        });
    }
    document.getElementById('totalLiters').innerText = totalLiters.toFixed(1) + " L√≠t";
    document.getElementById('totalKm').innerText = totalKm + " km";
    document.getElementById('avgCons').innerText = totalKm > 0 ? ((totalLiters/totalKm)*100).toFixed(2) : 0;
}

function deleteFuelLog(index) {
    if(window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a d√≤ng nh·∫≠t k√Ω n√†y kh√¥ng?")) { 
        fuelLogs.splice(index, 1); 
        saveAndRender(); 
        showToast("‚úÖ ƒê√£ x√≥a!");
    }
}

// --- T·ª∞ T√çNH NG√ÄY C√îNG & CH·ª¶ NH·∫¨T THEO TH√ÅNG ---
function autoCalcSundays() {
    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth(); // 0-based
    // T·ªïng s·ªë ng√†y trong th√°ng
    const totalDays = new Date(year, month + 1, 0).getDate();
    // ƒê·∫øm s·ªë ch·ªß nh·∫≠t
    let sundays = 0;
    for (let d = 1; d <= totalDays; d++) {
        if (new Date(year, month, d).getDay() === 0) sundays++;
    }
    // Ng√†y c√¥ng = t·ªïng s·ªë ng√†y trong th√°ng (VD: th√°ng 2/2026 = 28)
    // Ch·ªß nh·∫≠t = s·ªë ng√†y CN trong th√°ng (VD: 4)
    document.getElementById('ot_soNgayTrongThang').value = totalDays;
    document.getElementById('ot_soNgayChuNhat').value = sundays;
    saveSalarySettings();
    const monthName = `Th√°ng ${month + 1}/${year}`;
    showToast(`‚úÖ ${monthName}: ${totalDays} ng√†y, ${sundays} ch·ªß nh·∫≠t`);
}

// --- T√çNH L∆Ø∆†NG (ƒê√É C·∫¨P NH·∫¨T D√ôNG parseHours) ---
window.tinhLuong = function() {
    // C√°c √¥ Ti·ªÅn v√† Ng√†y c√¥ng -> D√πng parseMoney (X√≥a d·∫•u ch·∫•m ng√†n)
    const luongCB = parseMoney('ot_luongCanBan');
    const ngayThang = parseMoney('ot_soNgayTrongThang');
    const ngayCN = parseMoney('ot_soNgayChuNhat');
    
    // C√°c √¥ Gi·ªù -> D√πng parseHours (Gi·ªØ d·∫•u ch·∫•m th·∫≠p ph√¢n ƒë·ªÉ hi·ªÉu 8.5)
    const gio15 = parseHours('ot_gioTCTuong');
    const gio20 = parseHours('ot_gioTCNghi');
    
    document.getElementById('ketQuaLuong').style.display = 'block';
    
    if(luongCB < 0 || ngayThang < 0 || ngayCN < 0 || gio15 < 0 || gio20 < 0) { alert("S·ªë kh√¥ng ƒë∆∞·ª£c √¢m!"); return; }

    if (luongCB <= 0 || ngayThang <= 0) { alert("Nh·∫≠p L∆∞∆°ng CB v√† Ng√†y c√¥ng!"); return; }
    
    const ngayCongChuan = ngayThang - ngayCN;
    if (ngayCongChuan <= 0) { alert("S·ªë ng√†y c√¥ng kh√¥ng h·ª£p l·ªá"); return; }

    const luongGio = luongCB / (ngayCongChuan * 8);
    const tien15 = gio15 * luongGio * 1.5;
    const tien20 = gio20 * luongGio * 2.0;
    const tongTangCa = tien15 + tien20;
    
    // C√îNG TH·ª®C L∆Ø∆†NG T·∫†M T√çNH: (8,000,000 - 557,550) + T·ªïng TƒÉng Ca
    const thucNhan = (8000000 - 557550) + tongTangCa;

    document.getElementById('luongGioCoBan').innerText = formatMoney(luongGio) + "/gi·ªù";
    document.getElementById('tienTCTuong').innerText = formatMoney(tien15);
    document.getElementById('tienTCNghi').innerText = formatMoney(tien20);
    document.getElementById('tongTienTangCa').innerText = formatMoney(tongTangCa);
    document.getElementById('thucNhanTamTinh').innerText = formatMoney(thucNhan);
    
    reCalcSalaryAuto();
}

function reCalcSalaryAuto() {
    let h15 = parseFloat(document.getElementById('sum15').innerText) || 0;
    let h20 = parseFloat(document.getElementById('sum20').innerText) || 0;
    calculateOTMoney(h15, h20);
}

// --- NH·∫¨T K√ù TƒÇNG CA ---
let otLogs = [];
try { otLogs = JSON.parse(localStorage.getItem('otLogs')) || []; } catch(e) { otLogs = []; localStorage.removeItem('otLogs'); }
let editOTIndex = -1;

function addOTLog() {
    const date = document.getElementById('otLogDate').value;
    const type = parseFloat(document.getElementById('otLogType').value);
    const hours = parseFloat(document.getElementById('otLogHours').value);
    if(!date || isNaN(hours)) { alert("Nh·∫≠p ƒë·ªß th√¥ng tin!"); return; }
    if(hours <= 0) { alert("S·ªë gi·ªù ph·∫£i l·ªõn h∆°n 0!"); return; }
    
    if(editOTIndex > -1) {
        otLogs[editOTIndex] = { date, type, hours };
        cancelOTEdit();
        showToast("‚úÖ ƒê√£ c·∫≠p nh·∫≠t tƒÉng ca!");
    } else {
        otLogs.push({ date, type, hours });
        showToast("‚úÖ ƒê√£ th√™m tƒÉng ca!");
    }
    saveAndRenderOT();
    document.getElementById('otLogHours').value = '';
}

function editOTLog(index) {
    editOTIndex = index;
    const log = otLogs[index];
    document.getElementById('otLogDate').value = log.date;
    document.getElementById('otLogType').value = log.type;
    document.getElementById('otLogHours').value = log.hours;
    
    document.getElementById('btnAddOT').innerText = "üíæ C·∫≠p nh·∫≠t";
    document.getElementById('btnAddOT').classList.add('btn-update');
    document.getElementById('btnCancelOT').style.display = "inline-block";
    // --- T·ª∞ CU·ªòN L√äN ---
    document.getElementById('otLogDate').scrollIntoView({ behavior: 'smooth', block: 'center' });
}

function cancelOTEdit() {
    editOTIndex = -1;
    document.getElementById('otLogHours').value = '';
    document.getElementById('btnAddOT').innerText = "‚ûï Th√™m Nh·∫≠t K√Ω";
    document.getElementById('btnAddOT').classList.remove('btn-update');
    document.getElementById('btnCancelOT').style.display = "none";
}

function deleteOTLog(index) { 
    if(window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a d√≤ng tƒÉng ca n√†y kh√¥ng?")) { 
        otLogs.splice(index, 1); 
        saveAndRenderOT(); 
        showToast("‚úÖ ƒê√£ x√≥a!");
    } 
}
function saveAndRenderOT() { localStorage.setItem('otLogs', JSON.stringify(otLogs)); renderOTLogs(); }

function renderOTLogs() {
    const container = document.getElementById('otLogList');
    container.innerHTML = '';
    let sum15 = 0; let sum20 = 0;
    
    const sorted = [...otLogs].sort((a, b) => new Date(a.date) - new Date(b.date));

    if (sorted.length === 0) {
        container.innerHTML = `<div class="log-empty-state">Ch∆∞a c√≥ nh·∫≠t k√Ω tƒÉng ca n√†o</div>`;
    } else {
        // Th√™m header row
        const header = document.createElement('div');
        header.className = 'ot-log-header';
        header.innerHTML = `
            <div>Ng√†y</div>
            <div>Lo·∫°i</div>
            <div>Gi·ªù</div>
            <div>S·ª≠a/X√≥a</div>
        `;
        container.appendChild(header);
        
        sorted.forEach((log, index) => {
            if(log.type === 1.5) sum15 += log.hours;
            if(log.type === 2.0) sum20 += log.hours;
            const d = log.date.split('-');
            const shortDate = `${d[2]}/${d[1]}`;
            const typeLabel = log.type === 1.5 ? 'Th∆∞·ªùng' : 'OFF';
            const typeColor = log.type === 1.5 ? 'text-blue' : 'text-red';
            
            const card = document.createElement('div');
            card.className = `log-card-ot`;
            card.innerHTML = `
                <div class="ot-date">${shortDate}</div>
                <div class="${typeColor}" style="font-weight:700">${typeLabel}</div>
                <div class="${typeColor}" style="font-weight:700">${fmt(log.hours)}</div>
                <div class="ot-actions">
                    <button class="log-action-btn btn-edit" onclick="editOTLog(${index})" style="font-size:15px">‚úé</button>
                    <button class="log-action-btn btn-del" onclick="deleteOTLog(${index})" style="font-size:16px">‚úò</button>
                </div>
            `;
            container.appendChild(card);
        });
    }
    document.getElementById('sum15').innerText = fmt(sum15);
    document.getElementById('sum20').innerText = fmt(sum20);
    calculateOTMoney(sum15, sum20);
}

function calculateOTMoney(h15, h20) {
    // D√πng h√†m parseMoney m·ªõi ƒë·ªÉ x·ª≠ l√Ω s·ªë c√≥ d·∫•u ch·∫•m
    const luongCB = parseMoney('ot_luongCanBan');
    const ngayCong = parseMoney('ot_soNgayTrongThang');
    const ngayCN = parseMoney('ot_soNgayChuNhat');
    
    if(luongCB > 0 && ngayCong > 0) {
        const ngayChuan = ngayCong - ngayCN;
        const luongGio = luongCB / (ngayChuan * 8);
        
        const tien15 = h15 * 1.5 * luongGio;
        const tien20 = h20 * 2.0 * luongGio;
        const total = tien15 + tien20;
        
        document.getElementById('money15').innerText = formatMoney(tien15);
        document.getElementById('money20').innerText = formatMoney(tien20);
        document.getElementById('sumMoney').innerText = formatMoney(total);
    }
}

// --- NH·∫ÆC L·ªäCH XE (M·ªöI) ---
function toggleEdit(id, btn) {
    const el = document.getElementById(id);
    const isOpen = el.style.display === 'block';
    
    document.querySelectorAll('.edit-area').forEach(area => area.style.display = 'none');
    document.querySelectorAll('.btn-edit-toggle').forEach(b => {
        b.innerText = 'S·ª≠a';
        b.classList.remove('active');
    });

    if (!isOpen) {
        el.style.display = 'block';
        btn.innerText = 'Xong';
        btn.classList.add('active');
    } else {
        el.style.display = 'none';
        btn.innerText = 'S·ª≠a';
        btn.classList.remove('active');
    }
}

function toggleMaintenanceTable() {
    const table = document.getElementById('maintenanceTable');
    const btn = document.getElementById('btnShowLookup');
    
    if (table.style.display === 'table') {
        table.style.display = 'none';
        btn.innerText = 'Xem';
        btn.style.background = 'var(--blue-text)';
    } else {
        table.style.display = 'table';
        btn.innerText = 'ƒê√≥ng';
        btn.style.background = '#7f8c8d';
    }
}

function loadReminders() {
    ['dateRegistry', 'dateInsurance', 'odoMaintenance'].forEach(k => {
        const s = localStorage.getItem(k); 
        if (s) document.getElementById(k).value = s;
    });
    calcReminders(); 
}
function saveReminders() {
    ['dateRegistry', 'dateInsurance', 'odoMaintenance'].forEach(k => { 
        localStorage.setItem(k, document.getElementById(k).value); 
    });
    calcReminders();
}

function calcReminders() {
    const today = new Date(); today.setHours(0,0,0,0);
    [{id:'dateRegistry',t:'textRegistry'},{id:'dateInsurance',t:'textInsurance'}].forEach(item => {
        const v = document.getElementById(item.id).value, el = document.getElementById(item.t);
        if (!v) { el.innerText = "Ch∆∞a c√†i ng√†y"; el.style.color = "inherit"; }
        else {
            const diff = Math.ceil((new Date(v) - today) / (1000 * 60 * 60 * 24));
            if (diff < 0) { el.innerText = "QU√Å H·∫†N " + Math.abs(diff) + " ng√†y üî¥"; el.style.color = "var(--primary)"; }
            else if (diff <= 7) { el.innerText = "KH·∫®N C·∫§P: C√≤n " + diff + " ng√†y üî¥"; el.style.color = "var(--primary)"; }
            else if (diff <= 30) { el.innerText = "S·∫Øp h·∫øt h·∫°n: C√≤n " + diff + " ng√†y üü°"; el.style.color = "#d4a017"; }
            else { el.innerText = "An to√†n: C√≤n " + diff + " ng√†y üü¢"; el.style.color = "var(--accent)"; }
        }
    });
    const target = parseFloat(document.getElementById('odoMaintenance').value) || 0, elM = document.getElementById('textMaintenance');
    let cur = closingOdo; if (fuelLogs.length > 0) { const max = Math.max(...fuelLogs.map(l => l.odo)); if (max > cur) cur = max; }
    if (target === 0) elM.innerText = "Ch∆∞a c√†i m·ªëc ODO";
    else {
        const diffKm = target - cur;
        if (diffKm < 0) { elM.innerText = "QU√Å KM: L·ªë " + Math.abs(diffKm) + " km üî¥"; elM.style.color = "var(--primary)"; }
        else if (diffKm <= 500) { elM.innerText = "S·∫Øp h·∫°n: C√≤n " + diffKm + " km üü°"; elM.style.color = "#d4a017"; }
        else { elM.innerText = "An to√†n: C√≤n " + diffKm + " km üü¢"; elM.style.color = "var(--accent)"; }
    }
    updateExpertAdvice(cur);
}

function updateExpertAdvice(odo) {
    const el = document.getElementById('expertAdvice'); 
    let adv = "üí° <b>L∆∞u √Ω cho anh em:</b> ";
    if (odo === 0) adv += "Nh·∫≠p nh·∫≠t k√Ω d·∫ßu ƒë·ªÉ App theo d√µi b·∫£o d∆∞·ª°ng xe nh√©!";
    else if (odo < 3000) adv += "Xe m·ªõi ch·∫°y. M·ªëc <b>3k-5k km</b> ƒë·∫ßu anh em n√™n b√°o c√¥ng ty cho xe ƒëi si·∫øt l·∫°i g·∫ßm v√† thay nh·ªõt r√† m√°y nh√©.";
    else if (odo >= 3000 && odo < 8000) adv += "G·∫ßn m·ªëc 10.000km, anh em ƒë·ªÉ √Ω b√°o thay nh·ªõt m√°y v√† v·ªá sinh l·ªçc gi√≥ cho xe b·ªëc.";
    else if (odo >= 8000 && odo <= 12000) adv += "M·ªëc <b>10.000km</b>: N√™n b√°o thay nh·ªõt, l·ªçc nh·ªõt v√† nh·ªù k·ªπ thu·∫≠t xem qua m√° phanh cho an to√†n.";
    else if (odo >= 18000 && odo <= 22000) adv += "M·ªëc <b>20.000km</b>: R·∫•t c·∫ßn thay <b>L·ªçc D·∫ßu</b> ƒë·ªÉ tr√°nh h∆∞ kim phun, anh em l∆∞u √Ω nh√©.";
    else if (odo >= 38000 && odo <= 42000) adv += "M·ªëc <b>40.000km</b>: T·ªõi k·ª≥ b·∫£o d∆∞·ª°ng l·ªõn r·ªìi, anh em b√°o ƒë·ªôi xe ki·ªÉm tra d·∫ßu h·ªôp s·ªë, d·∫ßu c·∫ßu v√† n∆∞·ªõc m√°t.";
    else if (odo >= 78000 && odo <= 82000) adv += "M·ªëc <b>80.000km</b>: C·∫ßn l∆∞u √Ω thay d√¢y curoa v√† v·ªá sinh h·ªçng n·∫°p ƒë·ªÉ m√°y ch·∫°y √™m, ti·∫øt ki·ªám d·∫ßu.";
    else if (odo >= 98000) adv += "Xe ch·∫°y tr√™n <b>10 v·∫°n</b> r·ªìi, anh em n√™n ƒë·ªÉ √Ω k·ªπ h·ªá th·ªëng c√¥n v√† g·∫ßm b·ªá khi v·∫≠n h√†nh.";
    else adv += "Anh em nh·ªõ ki·ªÉm tra n∆∞·ªõc l√†m m√°t v√† √°p su·∫•t l·ªëp h√†ng tu·∫ßn ƒë·ªÉ xe ch·∫°y ·ªïn ƒë·ªãnh nh√©!";
    el.innerHTML = adv;
}

// --- SHARE & VISIT COUNT ---
async function shareApp() {
    if (navigator.share) { try { await navigator.share({url:'https://letinhclover.github.io/jntdriver'}); } catch(e){} }
    else {
        const t = document.createElement("input"); t.value = "https://letinhclover.github.io/jntdriver"; document.body.appendChild(t);
        t.select(); try { document.execCommand("copy"); showToast("ƒê√£ sao ch√©p Link!"); } catch(e){} document.body.removeChild(t);
    }
}
fetch("https://api.counterapi.dev/v1/letinhclover.github.io/jntdriver/up")
    .then(r=>r.json()).then(d=>{document.getElementById('visitCount').innerText="üëÄ L∆∞·ª£t truy c·∫≠p: "+d.count.toLocaleString()})
    .catch(e=>{document.getElementById('visitCount').style.display="none"});

// --- KH·ªûI T·∫†O ·ª®NG D·ª§NG (CH·∫†Y CU·ªêI C√ôNG, ƒê·∫¢M B·∫¢O TH·ª® T·ª∞ ƒê√öNG) ---
function initApp() {
    // 1. G√°n ng√†y h√¥m nay
    setToday('logDate');
    setToday('otLogDate');
    // 2. Load c√†i ƒë·∫∑t l∆∞∆°ng TR∆Ø·ªöC (quan tr·ªçng: s·ªë li·ªáu ph·∫£i c√≥ tr∆∞·ªõc khi render)
    loadSalarySettings();
    // 3. Render nh·∫≠t k√Ω (d·ª±a tr√™n s·ªë li·ªáu ƒë√£ load)
    renderLogs();
    renderOTLogs();
    // 4. Load nh·∫Øc l·ªãch xe
    loadReminders();
}
initApp();
</script>
</body>
</html>
